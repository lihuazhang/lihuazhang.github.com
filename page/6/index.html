<!DOCTYPE html>
<html lang="zh-cn">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="恒温" />


    
    


<meta property="og:type" content="website">
<meta property="og:title" content="八点在家">
<meta property="og:url" content="http://lihuazhang.github.io/page/6/index.html">
<meta property="og:site_name" content="八点在家">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="八点在家">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="八点在家" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.png">





    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">



<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>八点在家</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: false,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: undefined
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/images/avatar.jpeg" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">恒温</a></h1>
        </hgroup>

        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:lihuazhang@hotmail.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="https://github.com/lihuazhang" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Appium/">Appium</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Metro/">Metro</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebDriver/">WebDriver</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/capybara/">capybara</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cocos2d/">cocos2d</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cucumber/">cucumber</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gatling/">gatling</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jmeter/">jmeter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nexus-7/">nexus 7</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pageobject/">pageobject</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ruby/">ruby</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zsh/">zsh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/冯唐/">冯唐</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/南京/">南京</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/博客/">博客</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/听来的故事/">听来的故事</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/孩子/">孩子</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/年终总结/">年终总结</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/恐怖/">恐怖</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/抽烟/">抽烟</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/来自qqzone/">来自qqzone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/来自wechat/">来自wechat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/杭州/">杭州</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/电影/">电影</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/移动测试/">移动测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/陆犯焉识/">陆犯焉识</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/随笔/">随笔</a></li></ul>
                    </div>
                </section>
                
                
                

                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">恒温</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/images/avatar.jpeg" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">恒温</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:lihuazhang@hotmail.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/lihuazhang" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap">
  
    <article id="post-2012-04-21-webdriver-3-more-pageobjects" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/04/21/2012-04-21-webdriver-3-more-pageobjects/" class="article-date">
      <time datetime="2012-04-21T02:36:00.000Z" itemprop="datePublished">2012-04-21</time>
</a>

 
    <a href="/2012/04/21/2012-04-21-webdriver-3-more-pageobjects/#comments" title="查看评论">
        <i class="fa fa-comments-o" aria-hidden="true"></i>
        <span class="count-comment"></span>
        
        
            <span class="disqus-comment-count" data-disqus-identifier="2012/04/21/2012-04-21-webdriver-3-more-pageobjects/"></span>
        
    </a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/04/21/2012-04-21-webdriver-3-more-pageobjects/">WebDriver 3: more PageObjects - PageFactory</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>在上篇中，大致介绍了PageObjects。其实为了对PageObjects更好的支持，webdriver中还有一个<br><a href="http://code.google.com/p/selenium/wiki/PageFactory" target="_blank" rel="external">PageFactory</a>的概念。</p>
<blockquote>
<p>There is a PageFactory in the support package that provides support for this pattern, and helps to remove some boiler-plate code from your Page Objects at the same time.</p>
</blockquote>
<p>来看下,上篇中的百度搜索例子, 用PageFactory该如何实现。</p>
<ul>
<li>首先修改BaiduIndexPage</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.ahchoo.automation.page;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.WebElement;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.support.FindBy;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.support.How;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaiduIndexPage</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> WebDriver driver;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String url = <span class="string">"http://www.baidu.com"</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BaiduIndexPage</span><span class="params">(WebDriver driver)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.driver = driver;</div><div class="line">        driver.get(url);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@FindBy</span>(how = How.ID, using = <span class="string">"kw"</span>)</div><div class="line">    <span class="keyword">private</span> WebElement searchField;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> SearchResultPage <span class="title">searchFor</span><span class="params">(String text)</span> </span>&#123;</div><div class="line">        <span class="comment">// We continue using the element just as before</span></div><div class="line">        searchField.sendKeys(text);</div><div class="line">        searchField.submit();</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SearchResultPage(driver);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>可以看到这里使用了注释@FindBy， 这是一个注释类，我们来看下它的定义</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="meta">@interface</span> FindBy &#123;</div><div class="line">  <span class="function">How <span class="title">how</span><span class="params">()</span> <span class="keyword">default</span> How.ID</span>;</div><div class="line"></div><div class="line">  <span class="function">String <span class="title">using</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</div><div class="line"></div><div class="line">  <span class="function">String <span class="title">id</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</div><div class="line"></div><div class="line">  <span class="function">String <span class="title">name</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</div><div class="line"></div><div class="line">  <span class="function">String <span class="title">className</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</div><div class="line"></div><div class="line">  <span class="function">String <span class="title">css</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</div><div class="line"></div><div class="line">  <span class="function">String <span class="title">tagName</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</div><div class="line"></div><div class="line">  <span class="function">String <span class="title">linkText</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</div><div class="line"></div><div class="line">  <span class="function">String <span class="title">partialLinkText</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</div><div class="line"></div><div class="line">  <span class="function">String <span class="title">xpath</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们可以知道其实FindBy注释就是实现了<code>driver.findElement(By)</code>,用FindBy可以从无数findElement方法中解脱出来(如果你页面有很多元素的时候)。</p>
<ul>
<li>然后要用工厂模式生成BaiduIndexPage对象</li>
</ul>
<p>在SearchTest.java 里<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">BaiduIndexPage home = PageFactory.initElements(driver, BaiduIndexPage.class);</div><div class="line"><span class="comment">// BaiduIndexPage home = new BaiduIndexPage(driver);</span></div></pre></td></tr></table></figure></p>
<p>将WebDriver实例和BaiduIndexPage.class传给initElements方法，该方法会更具反射生成BaiduIndexPage实例，必须注意的是，使用PageFactory，我们的页面对象必须有<br>一个带有WebDriver类型参数的构造方法。</p>
<blockquote>
<p>This method will attempt to instantiate the class given to it, preferably using a constructor<br>which takes a WebDriver instance as its only argument or falling back on a no-arg constructor.</p>
</blockquote>
<p>PageFactory基本需要关注的就是：</p>
<pre><code>1. Findby注释
2. PageFactory.initElements
</code></pre><p>我们继续改造，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.ahchoo.automation.page;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.WebElement;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.support.FindBy;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.support.How;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.support.PageFactory;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaiduIndexPage</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> WebDriver driver;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String url = <span class="string">"http://www.baidu.com"</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BaiduIndexPage</span><span class="params">(WebDriver driver)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.driver = driver;</div><div class="line">        driver.get(url);</div><div class="line">        PageFactory.initElements(driver, <span class="keyword">this</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@FindBy</span>(how = How.ID, using = <span class="string">"kw"</span>)</div><div class="line">    <span class="keyword">private</span> WebElement searchField;</div><div class="line"></div><div class="line">    <span class="meta">@FindBy</span>(how = How.ID, using = <span class="string">"lg"</span>)</div><div class="line">    <span class="keyword">private</span> WebElement logo;</div><div class="line">    </div><div class="line">    <span class="meta">@FindBy</span>(how = How.CLASS_NAME, using = <span class="string">"s_btn"</span>)</div><div class="line">    <span class="keyword">private</span> WebElement baidYiXiauButton;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> SearchResultPage <span class="title">searchFor</span><span class="params">(String text)</span> </span>&#123;</div><div class="line">        <span class="comment">// We continue using the element just as before</span></div><div class="line">        searchField.sendKeys(text);</div><div class="line">        searchField.submit();</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SearchResultPage(driver);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">idLogoDisplay</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> logo.isDisplayed();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasBaidYiXiauButton</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> baidYiXiauButton.isDisplayed();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们将<code>PageFactory.initElements(driver, this);</code>放在页面类的构造函数里，这样就不需要将PageFactory暴露到TestCase中去。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">package</span> com.ahchoo.automation.page;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.WebElement;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.support.FindBy;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.support.How;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.support.PageFactory;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SearchResultPage</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> WebDriver driver;</div><div class="line">    </div><div class="line">    <span class="comment">/* 推广链接所在位置 */</span></div><div class="line">    <span class="meta">@FindBy</span>(how=How.ID, using=<span class="string">"ec_im_container"</span>)</div><div class="line">    <span class="keyword">private</span> WebElement adDiv;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SearchResultPage</span><span class="params">(WebDriver driver)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.driver = driver;</div><div class="line">        PageFactory.initElements(driver, <span class="keyword">this</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTitle</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> driver.getTitle();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getContent</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> driver.getPageSource();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isAdDivDisplayed</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> adDiv.isDisplayed();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>下面是测试用例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">package</span> com.ahchoo.automation;</div><div class="line"></div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.assertTrue;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.junit.After;</div><div class="line"><span class="keyword">import</span> org.junit.Before;</div><div class="line"><span class="keyword">import</span> org.junit.Test;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.firefox.FirefoxDriver;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.support.PageFactory;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.ahchoo.automation.page.BaiduIndexPage;</div><div class="line"><span class="keyword">import</span> com.ahchoo.automation.page.SearchResultPage;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Unit test for simple App.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SearchTest</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> WebDriver driver;</div><div class="line"></div><div class="line">    <span class="meta">@Before</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</div><div class="line">        driver = <span class="keyword">new</span> FirefoxDriver();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@After</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tearDown</span><span class="params">()</span> </span>&#123;</div><div class="line">        driver.close();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchTest</span><span class="params">()</span> </span>&#123;</div><div class="line">        BaiduIndexPage home = <span class="keyword">new</span> BaiduIndexPage(driver);</div><div class="line">        assertTrue(home.hasBaidYiXiauButton());</div><div class="line">        assertTrue(home.idLogoDisplay());</div><div class="line">        SearchResultPage searchResult = home.searchFor(<span class="string">"pizza"</span>);</div><div class="line">        assertTrue(searchResult.isAdDivDisplayed());</div><div class="line">        assertTrue(searchResult.getTitle().contains(<span class="string">"pizza"</span>));</div><div class="line">        assertTrue(searchResult.getContent().contains(<span class="string">"pizza"</span>));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>改造完毕，我可以保证这个Testcase能运行的很欢。</p>
<p>######总结<br>可以看到使用PageFactory可以使页面类代码更加清晰，维护也相对简单许多。如果你也使用PageObjects的话，<br>不妨试试看。如果你想多了解PageFactory的话，请移步<a href="http://code.google.com/p/selenium/wiki/PageFactor" target="_blank" rel="external">PageFactory</a>，<br>一定能让你受益匪浅。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术/">技术</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WebDriver/">WebDriver</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-2012-04-20-webdriver2" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/04/20/2012-04-20-webdriver2/" class="article-date">
      <time datetime="2012-04-20T11:07:00.000Z" itemprop="datePublished">2012-04-20</time>
</a>

 
    <a href="/2012/04/20/2012-04-20-webdriver2/#comments" title="查看评论">
        <i class="fa fa-comments-o" aria-hidden="true"></i>
        <span class="count-comment"></span>
        
        
            <span class="disqus-comment-count" data-disqus-identifier="2012/04/20/2012-04-20-webdriver2/"></span>
        
    </a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/04/20/2012-04-20-webdriver2/">WebDriver 2: PageObject</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>在上篇中，已经搭建好了环境。假设我们已经有这样一个环境</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">── pom.xml</div><div class="line">── src</div><div class="line">   ├── main</div><div class="line">   │   └── java</div><div class="line">   │       └── com</div><div class="line">   │           └── ahchoo</div><div class="line">   │               └── automation</div><div class="line">   │                   └── App.java</div><div class="line">   └── <span class="built_in">test</span></div><div class="line">       └── java</div><div class="line">           └── com</div><div class="line">               └── ahchoo</div><div class="line">                   └── automation</div><div class="line">                       └── AppTest.java</div></pre></td></tr></table></figure>
<p>在这个基础上，我们要实现一个访问百度，查询一个关键字之后，跳转到结果界面。</p>
<ul>
<li>开始之前，我们先想想传统的WebDriver代码应该怎么写？</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.ahchoo.automation;</div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.junit.After;</div><div class="line"><span class="keyword">import</span> org.junit.Before;</div><div class="line"><span class="keyword">import</span> org.junit.Test;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.firefox.FirefoxDriver;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.By;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.WebElement;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SearchTest</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> WebDriver driver;</div><div class="line"></div><div class="line">    <span class="meta">@Before</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</div><div class="line">        driver = <span class="keyword">new</span> FirefoxDriver();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@After</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tearDown</span><span class="params">()</span> </span>&#123;</div><div class="line">        driver.close();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchTest</span><span class="params">()</span> </span>&#123;</div><div class="line">        driver.get(<span class="string">"http://www.baidu.com"</span>);</div><div class="line">        WebElement input = driver.findElement(By.id(<span class="string">"kw"</span>));</div><div class="line">        input.clear();</div><div class="line">        input.sendKeys(<span class="string">"Pizza"</span>);</div><div class="line">        input.submit();</div><div class="line">        assertTrue(driver.getTitle().contains(<span class="string">"Pizza"</span>));</div><div class="line">        assertTrue(driver.getContent().contains(<span class="string">"Pizza"</span>));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果只有一个测试用例，这样写也很清爽，但是如果有许许多多这样的测试用例，如果input的id发生变化了，就要把<br>所有的用到这个input的用例找出来，一一修改，这无疑是个大工程。</p>
<ul>
<li><p>让我们再来看看PageObjects，首先，我们要创建页面对象， 整个过程涉及2个页面</p>
<ol>
<li>百度首页</li>
<li>search结果页</li>
</ol>
</li>
</ul>
<p>所以我们也就有两个pageobjects， 将pageobjects class放在main source下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">package</span> com.ahchoo.automation.page;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.openqa.selenium.By;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.WebElement;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaiduIndexPage</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> WebDriver driver;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String url = <span class="string">"http://www.baidu.com"</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BaiduIndexPage</span><span class="params">(WebDriver driver)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.driver = driver;</div><div class="line">        driver.get(url);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> SearchResultPage <span class="title">searchFor</span><span class="params">(String term)</span> </span>&#123;</div><div class="line">        <span class="comment">// Baidu search input id is "kw"</span></div><div class="line">        WebElement searchField = driver.findElement(By.id(<span class="string">"kw"</span>));</div><div class="line">        searchField.clear();</div><div class="line">        searchField.sendKeys(term);</div><div class="line">        searchField.submit();</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SearchResultPage(driver);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">package</span> com.ahchoo.automation.page;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SearchResultPage</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">private</span> WebDriver driver;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SearchResultPage</span><span class="params">(WebDriver driver)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.driver = driver;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTitle</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> driver.getTitle();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getContent</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> driver.getPageSource();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>接着创建testcase，把测试用例放在test source目录下</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">package</span> com.ahchoo.automation;</div><div class="line"></div><div class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.junit.After;</div><div class="line"><span class="keyword">import</span> org.junit.Before;</div><div class="line"><span class="keyword">import</span> org.junit.Test;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</div><div class="line"><span class="keyword">import</span> org.openqa.selenium.firefox.FirefoxDriver;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.ahchoo.automation.page.BaiduIndexPage;</div><div class="line"><span class="keyword">import</span> com.ahchoo.automation.page.SearchResultPage;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SearchTest</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> WebDriver driver;</div><div class="line"></div><div class="line">    <span class="meta">@Before</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> </span>&#123;</div><div class="line">        driver = <span class="keyword">new</span> FirefoxDriver();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@After</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tearDown</span><span class="params">()</span> </span>&#123;</div><div class="line">        driver.close();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Test</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">searchTest</span><span class="params">()</span> </span>&#123;</div><div class="line">        BaiduIndexPage home = <span class="keyword">new</span> BaiduIndexPage(driver);</div><div class="line">        SearchResultPage searchResult = home.searchFor(<span class="string">"pizza"</span>);</div><div class="line">        assertTrue(searchResult.getTitle().contains(<span class="string">"pizza"</span>));</div><div class="line">        assertTrue(searchResult.getContent().contains(<span class="string">"pizza"</span>));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后我们运行下看看</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">➜  ahcoo  mvn test</div><div class="line">[INFO] Scanning for projects...</div><div class="line">[INFO]                                                                         </div><div class="line">[INFO] ------------------------------------------------------------------------</div><div class="line">[INFO] Building ahcoo 1.0-SNAPSHOT</div><div class="line">[INFO] ------------------------------------------------------------------------</div><div class="line">[INFO] </div><div class="line">[INFO] --- maven-resources-plugin:2.4.3:resources (default-resources) @ ahcoo ---</div><div class="line">[WARNING] Using platform encoding (EUC_CN actually) to copy filtered resources, i.e. build is platform dependent!</div><div class="line">[INFO] skip non existing resourceDirectory /Volumes/MacBackUp/ahcoo/src/main/resources</div><div class="line">[INFO] </div><div class="line">[INFO] --- maven-compiler-plugin:2.3.2:compile (default-compile) @ ahcoo ---</div><div class="line">[INFO] Nothing to compile - all classes are up to date</div><div class="line">[INFO] </div><div class="line">[INFO] --- maven-resources-plugin:2.4.3:testResources (default-testResources) @ ahcoo ---</div><div class="line">[WARNING] Using platform encoding (EUC_CN actually) to copy filtered resources, i.e. build is platform dependent!</div><div class="line">[INFO] skip non existing resourceDirectory /Volumes/MacBackUp/ahcoo/src/test/resources</div><div class="line">[INFO] </div><div class="line">[INFO] --- maven-compiler-plugin:2.3.2:testCompile (default-testCompile) @ ahcoo ---</div><div class="line">[INFO] Nothing to compile - all classes are up to date</div><div class="line">[INFO] </div><div class="line">[INFO] --- maven-surefire-plugin:2.7.2:test (default-test) @ ahcoo ---</div><div class="line">[INFO] Surefire report directory: /Volumes/MacBackUp/ahcoo/target/surefire-reports</div><div class="line"></div><div class="line">-------------------------------------------------------</div><div class="line"> T E S T S</div><div class="line">-------------------------------------------------------</div><div class="line">Running com.ahchoo.automation.SearchTest</div><div class="line">Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 21.474 sec</div><div class="line"></div><div class="line">Results :</div><div class="line"></div><div class="line">Tests run: 1, Failures: 0, Errors: 0, Skipped: 0</div><div class="line"></div><div class="line">[INFO] ------------------------------------------------------------------------</div><div class="line">[INFO] BUILD SUCCESS</div><div class="line">[INFO] ------------------------------------------------------------------------</div><div class="line">[INFO] Total time: 25.953s</div><div class="line">[INFO] Finished at: Fri Apr 20 21:53:03 CST 2012</div><div class="line">[INFO] Final Memory: 5M/81M</div><div class="line">[INFO] ------------------------------------------------------------------------</div></pre></td></tr></table></figure>
<p>Pass！</p>
<p>这就是当下流行的pageobjects，将页面固有的属性和逻辑抽象成类。然后在测试代码里面调用，这样有一个很大的好处，<br>如果页面变动了，只需要变动页面对象，不需要去无数测试用例里去寻找并更改。</p>
<p><blockquote></blockquote></p>
<p></p><p>Within your web app’s UI there are areas that your tests interact with. A Page Object simply models these as objects within the test code. This reduces the amount of duplicated code and means that if the UI changes, the fix need only be applied in one place.<br></p><br><small><br> simon.m.stewart  <a href="http://code.google.com/p/selenium/wiki/PageObjects" target="_blank" rel="external">PageObject</a><br></small><br><p></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术/">技术</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WebDriver/">WebDriver</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-2012-04-19-capybara-plus-cucumber-plus-webdriverzi-dong-hua-ce-shi-kuang-jia" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/04/19/2012-04-19-capybara-plus-cucumber-plus-webdriverzi-dong-hua-ce-shi-kuang-jia/" class="article-date">
      <time datetime="2012-04-19T13:13:00.000Z" itemprop="datePublished">2012-04-19</time>
</a>

 
    <a href="/2012/04/19/2012-04-19-capybara-plus-cucumber-plus-webdriverzi-dong-hua-ce-shi-kuang-jia/#comments" title="查看评论">
        <i class="fa fa-comments-o" aria-hidden="true"></i>
        <span class="count-comment"></span>
        
        
            <span class="disqus-comment-count" data-disqus-identifier="2012/04/19/2012-04-19-capybara-plus-cucumber-plus-webdriverzi-dong-hua-ce-shi-kuang-jia/"></span>
        
    </a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/04/19/2012-04-19-capybara-plus-cucumber-plus-webdriverzi-dong-hua-ce-shi-kuang-jia/">使用 Capybara， Cucumber 和 WebDriver 实现自动化测试</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>我面试的时候，BOSS对我说，我们是要求自动化的。我想这我会啊。BOSS又说，我们也有一套自动化的框架。我想那更好。然后等我入职之后，发现毛框架也没有，只有四个完全不会代码的测试攻城狮。</p>
<p>老板说要自动化，我说自动化啊？我花了几天的时间温习了我熟悉的<code>JAVA+Junit+SeleniumRC</code>，否定了这个框架，一来语言太重，二来都不会coding。我很苦恼地向BOSS抱怨了，他说用脚本语言吧，于是我就想要不就用<code>python+pyunit+webdriver</code>，在google打工的时候，接触的就是这个框架。BOSS想了想，说用ruby吧。原因在他是ruby的超级粉丝。</p>
<p>于是我找到了<code>cucumber+capybara+webdriver</code>，这也是我第一次接触ruby，第一次接触BDD。而我选用这个框架的原因如下：</p>
<pre><code>1. cucumber有一套自己的DSL，任何会写测试用例的人都会写。
2. 对于这套框架要学的ruby知识，学起来相对容易。
3. 公司文化。
</code></pre><p>前面都是废话，下面开始进入正题。</p>
<p>##功于善其事，必先利其器</p>
<ul>
<li>首先搭建环境，确定有ruby的环境。安装必要的gem<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">gem install cucumber </div><div class="line">gem install capybara</div><div class="line">gem ins tall selenium-webdriver</div></pre></td></tr></table></figure>
</li>
</ul>
<p><em><a href="http://cukes.info/" target="_blank" rel="external">Cucumber</a> <a href="https://github.com/jnicklas/capybara" target="_blank" rel="external">Capybara</a> <a href="http://code.google.com/p/selenium/" target="_blank" rel="external">WebDriver</a></em></p>
<ul>
<li>建立个空项目，将gem加入gemfile</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">source <span class="string">"http://ruby.taobao.org/"</span></div><div class="line">gem <span class="string">'cucumber'</span>, <span class="string">'&gt;= 1.1.9'</span></div><div class="line">gem <span class="string">"capybara"</span>, <span class="string">"~&gt; 1.1.2"</span></div><div class="line">gem <span class="string">'selenium-webdriver'</span>, <span class="string">'&gt;= 2.20.0'</span></div></pre></td></tr></table></figure>
<ul>
<li>先简单介绍一下cucumber</li>
</ul>
<p>我们在这个空项目下运行<code>cucumber</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">zhangmatoMacBook-Pro:<span class="built_in">test</span> lihuazhang$ cucumber</div><div class="line">You don<span class="string">'t have a '</span>features<span class="string">' directory.  Please create one to get started.</span></div><div class="line">See http://cukes.info/ for more information.</div></pre></td></tr></table></figure>
<p>可以看出cucumber会去寻找<code>features</code>目录，先创建一个features目录。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">zhangmatoMacBook-Pro:<span class="built_in">test</span> lihuazhang$ mkdir features</div><div class="line">zhangmatoMacBook-Pro:<span class="built_in">test</span> lihuazhang$ ls</div><div class="line">features</div><div class="line">zhangmatoMacBook-Pro:<span class="built_in">test</span> lihuazhang$ cucumber</div><div class="line">0 scenarios</div><div class="line">0 steps</div><div class="line">0m0.000s</div></pre></td></tr></table></figure>
<p>因为在features下面什么都没有，所以运行结果都是零。</p>
<p>那我们创建一个feature，cucumber把feature都命名为xxx.feature, 而每个feature有多个scenario。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">Feature:</span> Adding</div><div class="line"></div><div class="line">    <span class="symbol">Scenario:</span> Add two numbers</div><div class="line">        Given the input <span class="string">"2+2"</span></div><div class="line">        When the calculator is run</div><div class="line">        Then the output should be <span class="string">"4"</span></div><div class="line">    <span class="symbol">Scenario:</span> Minus two numbers</div><div class="line">        Given the input <span class="string">"2-1"</span></div><div class="line">        When the calculator is run</div><div class="line">        Then the output should be <span class="string">"0"</span></div></pre></td></tr></table></figure>
<p>cucumber使用<code>Given/When/Then</code>这种叫做<a href="https://github.com/cucumber/cucumber/wiki/Gherkin" target="_blank" rel="external">gherkin</a>的可描述性语言(DSL)。</p>
<p>feature文件中的每个Given/When/Then步骤在Step文件中都有对应的Ruby执行代码，两类文件通过正则表达式相关联。后面马上讲到。</p>
<p>让我们再来运行一遍</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">zhangmatoMacBook-<span class="symbol">Pro:</span>test lihuazhang$ cucumber </div><div class="line"><span class="symbol">Feature:</span> Adding</div><div class="line"></div><div class="line">  <span class="symbol">Scenario:</span> Add two numbers       <span class="comment"># features/test.feature:3</span></div><div class="line">    Given the input <span class="string">"2+2"</span>         <span class="comment"># features/test.feature:4</span></div><div class="line">    When the calculator is run    <span class="comment"># features/test.feature:5</span></div><div class="line">    Then the output should be <span class="string">"4"</span> <span class="comment"># features/test.feature:6</span></div><div class="line"></div><div class="line">  <span class="symbol">Scenario:</span> Minus two numbers     <span class="comment"># features/test.feature:7</span></div><div class="line">    Given the input <span class="string">"2-1"</span>         <span class="comment"># features/test.feature:8</span></div><div class="line">    When the calculator is run    <span class="comment"># features/test.feature:9</span></div><div class="line">    Then the output should be <span class="string">"0"</span> <span class="comment"># features/test.feature:10</span></div><div class="line"></div><div class="line"><span class="number">2</span> scenarios (<span class="number">2</span> undefined)</div><div class="line"><span class="number">6</span> steps (<span class="number">6</span> undefined)</div><div class="line">0m<span class="number">0</span>.<span class="number">005</span>s</div><div class="line"></div><div class="line">You can implement step definitions <span class="keyword">for</span> undefined steps with these <span class="symbol">snippets:</span></div><div class="line"></div><div class="line">Given /^the input <span class="string">"([^"</span>]*)<span class="string">"$/ do |arg1|</span></div><div class="line">  pending # express the regexp above with the code you wish you had</div><div class="line">end</div><div class="line"></div><div class="line">When /^the calculator is run$/ do</div><div class="line">  pending # express the regexp above with the code you wish you had</div><div class="line">end</div><div class="line"></div><div class="line">Then /^the output should be "([^<span class="string">"]*)"</span>$/ <span class="keyword">do</span> <span class="params">|arg1|</span></div><div class="line">  pending <span class="comment"># express the regexp above with the code you wish you had</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">If you want snippets <span class="keyword">in</span> a different programming language,</div><div class="line">just make sure a file with the appropriate file extension</div><div class="line">exists where cucumber looks <span class="keyword">for</span> step definitions.</div></pre></td></tr></table></figure>
<p>可以看到我们运行了2个scenarios,6个steps，都没有定义，于是cucumber仁慈的告诉了我们如何实现。于是我们就要开始写step了。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#小小作弊下，就不写的漂亮了。</span></div><div class="line">Given /^the input <span class="string">"([^"</span>]*)<span class="string">"$/ do |statement|</span></div><div class="line">    @answer = eval statement</div><div class="line">end</div><div class="line"></div><div class="line">When /^the calculator is run$/ do</div><div class="line">    puts "Run~<span class="string">"</span></div><div class="line">end</div><div class="line"></div><div class="line">Then /^the output should be "([^<span class="string">"]*)"</span>$/ <span class="keyword">do</span> <span class="params">|answer|</span></div><div class="line">    @answer == answer</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>我们再来运行一遍</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">zhangmatoMacBook-<span class="symbol">Pro:</span>test lihuazhang$ cucumber </div><div class="line"><span class="symbol">Feature:</span> Adding</div><div class="line"></div><div class="line">  <span class="symbol">Scenario:</span> Add two numbers       <span class="comment"># features/test.feature:3</span></div><div class="line">    Given the input <span class="string">"2+2"</span>         <span class="comment"># features/step_definitions/test_step.rb:1</span></div><div class="line">    When the calculator is run    <span class="comment"># features/step_definitions/test_step.rb:5</span></div><div class="line">      Run~</div><div class="line">    Then the output should be <span class="string">"4"</span> <span class="comment"># features/step_definitions/test_step.rb:9</span></div><div class="line"></div><div class="line">  <span class="symbol">Scenario:</span> Minus two numbers     <span class="comment"># features/test.feature:7</span></div><div class="line">    Given the input <span class="string">"2-1"</span>         <span class="comment"># features/step_definitions/test_step.rb:1</span></div><div class="line">    When the calculator is run    <span class="comment"># features/step_definitions/test_step.rb:5</span></div><div class="line">      Run~</div><div class="line">    Then the output should be <span class="string">"0"</span> <span class="comment"># features/step_definitions/test_step.rb:9</span></div><div class="line"></div><div class="line"><span class="number">2</span> scenarios (<span class="number">2</span> passed)</div><div class="line"><span class="number">6</span> steps (<span class="number">6</span> passed)</div><div class="line">0m<span class="number">0</span>.<span class="number">005</span>s</div></pre></td></tr></table></figure>
<p>哇，恭喜都通过了。</p>
<p>好，关于cucumber的介绍就到这里，具体可以去看看<a href="http://www.cnblogs.com/CloudTeng/articles/2214293.html" target="_blank" rel="external">Cucumber的目录结构和执行过程</a></p>
<ul>
<li>在简单介绍下Capybara</li>
</ul>
<p>Capybara是水豚的意思，在水豚之前有一个老鼠，叫做webrat，你如果在google上搜索<code>capybara webrat</code>的话，会发现一大推类似</p>
<blockquote><br>Cucumber: Switching from Webrat to Capybara - cakebaker<br>cakebaker.42dh.com/…/cucumber-switching-from… - 网页快照 - 翻译此页<br>19 Sep 2010 – Fortunately, there is an alternative working with both Rails versions: Capybara. And so I decided to make the switch from Webrat to Capybara.<br></blockquote>

<p>Webrat逐渐被Capybara取代，就像selenium逐渐被webdriver取代。</p>
<p>Capybara主要是用来测试rails和Rack应用的。官网上说</p>
<blockquote><br>Capybara helps you test Rails and Rack applications by simulating how a real user would interact with your app. It is agnostic about the driver running your tests and comes with Rack::Test and Selenium support built in. WebKit is supported through an external gem.<br></blockquote>

<p>我们主要用Capybara和Webdriver结合起来进行网页自动化测试。（注意：Capybara不支持selenium rc）</p>
<p>详细请见<a href="https://github.com/jnicklas/capybara" target="_blank" rel="external">Capybara</a>,里面讲的非常详细了。</p>
<p>##小试牛刀<br>在了解了cucumber和capybara之后，我们可以正式开始写点东西。 在空项目底下，建立类似的目录结构</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">├── features</div><div class="line">    ├── example</div><div class="line">       ├── example.feature</div><div class="line">       ├── step_definitions</div><div class="line">       │   └── example_steps.rb</div><div class="line">       └── support</div><div class="line">           └── env.rb</div></pre></td></tr></table></figure>
<p>我们这个例子是访问百度</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="symbol">Feature:</span> Using baidu</div><div class="line"></div><div class="line"><span class="symbol">Scenario:</span> Searching <span class="keyword">for</span> a term</div><div class="line"></div><div class="line">Given I am on baidu.com</div><div class="line">When I enter <span class="string">"pizza"</span></div><div class="line">And I press <span class="string">"百度一下"</span></div><div class="line">Then I should see <span class="string">"pizza_百度百科"</span></div></pre></td></tr></table></figure>
<p>Given/When/And/Then很明了的告诉我们，打开百度，输入pizza，然后点击百度一下，然后就能看到pizza_百度百科。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">Given /^I am on baidu\.com$/ <span class="keyword">do</span></div><div class="line">  Capybara.app_host = <span class="string">"http://www.baidu.com"</span></div><div class="line">  visit(<span class="string">'/'</span>)</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">When /^I enter <span class="string">"([^"</span>]*)<span class="string">"$/ do |term|</span></div><div class="line">  fill_in('wd',:with =&gt; term)</div><div class="line">end</div><div class="line"></div><div class="line">When /^(?:|I )press "([^<span class="string">"]*)"</span>$/ <span class="keyword">do</span> <span class="params">|button|</span></div><div class="line">  puts button</div><div class="line">  click_button(button)</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">Then /^(?<span class="symbol">:|I</span> )should see <span class="string">"([^"</span>]*)<span class="string">"$/ do |text|</span></div><div class="line">  if page.respond_to? :should</div><div class="line">    page.should have_content(text)</div><div class="line">  else</div><div class="line">    assert page.has_content?(text)</div><div class="line">  end</div><div class="line">end</div></pre></td></tr></table></figure>
<p>接着就是值得一提的env.rb，这是cucumber的环境配置文件。</p>
<blockquote><br>The file features/support/env.rb is always the very first file to be loaded when Cucumber starts a test run. You use it to prepare the environment for the rest of your support and step definition code to operate.<br></blockquote>

<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">require</span> <span class="string">'capybara'</span></div><div class="line"><span class="keyword">require</span> <span class="string">'capybara/cucumber'</span></div><div class="line"><span class="keyword">require</span> <span class="string">'capybara/dsl'</span></div><div class="line"></div><div class="line">Capybara.app_host = <span class="string">"http://www.baidu.com"</span></div><div class="line">Capybara.default_driver = <span class="symbol">:selenium</span></div></pre></td></tr></table></figure>
<p>让我们来运行一下</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">zhangmatoMacBook-<span class="symbol">Pro:</span>features lihuazhang$ cucumber example/example.feature </div><div class="line"><span class="symbol">Feature:</span> Using baidu</div><div class="line"></div><div class="line">  <span class="symbol">Scenario:</span> Searching <span class="keyword">for</span> a term   <span class="comment"># example/example.feature:4</span></div><div class="line">    Given I am on baidu.com        <span class="comment"># example/step_definitions/example_steps.rb:1</span></div><div class="line">    When I enter <span class="string">"pizza"</span>           <span class="comment"># example/step_definitions/example_steps.rb:6</span></div><div class="line">    And I press <span class="string">"百度一下"</span>             <span class="comment"># example/step_definitions/example_steps.rb:10</span></div><div class="line">      百度一下</div><div class="line">    Then I should see <span class="string">"pizza_百度百科"</span> <span class="comment"># example/step_definitions/example_steps.rb:15</span></div><div class="line"></div><div class="line"><span class="number">1</span> scenario (<span class="number">1</span> passed)</div><div class="line"><span class="number">4</span> steps (<span class="number">4</span> passed)</div><div class="line">0m9.<span class="number">184</span>s</div></pre></td></tr></table></figure>
<p>Nice!</p>
<p>至此，基本的框架搭好了。至于如何配置不同的浏览器，以及如何和page object配合，我们以后再讲。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术/">技术</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/capybara/">capybara</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cucumber/">cucumber</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-2012-04-06-webdriver-1-post" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/04/06/2012-04-06-webdriver-1-post/" class="article-date">
      <time datetime="2012-04-06T10:18:00.000Z" itemprop="datePublished">2012-04-06</time>
</a>

 
    <a href="/2012/04/06/2012-04-06-webdriver-1-post/#comments" title="查看评论">
        <i class="fa fa-comments-o" aria-hidden="true"></i>
        <span class="count-comment"></span>
        
        
            <span class="disqus-comment-count" data-disqus-identifier="2012/04/06/2012-04-06-webdriver-1-post/"></span>
        
    </a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/04/06/2012-04-06-webdriver-1-post/">WebDriver 1: Set up WebDriver using Maven3</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><br></p><h3>1. Learn Maven3 first.</h3><br>  This is quite simple. Go through <a href="http://maven.apache.org/guides/getting-started/maven-in-five-minutes.html" target="_blank" rel="external">Maven in 5 Minutes</a><br>  That’s quite enough.<br><p></p>

<p><br></p><h3>2. Set up project</h3><br>Using the command in Maven in 5 Minutes to create a project using your own groupId and artifactId.<br><pre class="prettyprint"><br>mvn archetype:generate -DgroupId=com.ahchoo.automation -DartifactId=ahcoo -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false<br></pre><br><p></p>

<p><br>Change the pom.xml to add Junit and WebDriver dependencies<br><pre class="prettyprint"><br>&lt;project&gt;<br>…<br>    &lt;dependencies&gt;<br>        &lt;dependency&gt;<br>            &lt;groupId&gt;junit&lt;/groupId&gt;<br>            &lt;artifactId&gt;junit&lt;/artifactId&gt;<br>            &lt;version&gt;4.10&lt;/version&gt;<br>            &lt;scope&gt;test&lt;/scope&gt;<br>        &lt;/dependency&gt;<br>        &lt;dependency&gt;<br>            &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;<br>            &lt;artifactId&gt;selenium-java&lt;/artifactId&gt;<br>            &lt;version&gt;2.20.0&lt;/version&gt;<br>            &lt;/dependency&gt;<br>            &lt;/dependencies&gt;&lt;/scope&gt;&lt;/version&gt;&lt;/artifactId&gt;&lt;/groupId&gt;<br>        &lt;/dependency&gt;<br>    &lt;/dependencies&gt;<br>…<br>&lt;/project&gt;<br></pre><br>Then run <code class="cmd">mvn clean install</code><br></p>

<p><br></p><h3>3. Using eclipse to import this project</h3><br>install <a href="http://eclipse.org/m2e/" target="_blank" rel="external">m2eclipse</a> and<br>run command in the project root directory:<br><pre class="prettyprint"><br>mvn eclipse:clean<br>mvn eclipse:eclipse<br></pre><br><br>open eclise, click File and choose Import:<br><p><br>    <img src="/photos/1.png"><br></p><br>Choose Existing Projects into Workspace<br><p><br>    <img src="/photos/2.png"><br></p>

<p>After import, you will see the file tree in eclipse project explorer:</p>
<p><br><img src="/photos/3.png"><br></p><br><p></p>

<p>Thus the environment is set up.</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术/">技术</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WebDriver/">WebDriver</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-2012-03-08-learn-vim-3-post" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/03/08/2012-03-08-learn-vim-3-post/" class="article-date">
      <time datetime="2012-03-08T10:18:00.000Z" itemprop="datePublished">2012-03-08</time>
</a>

 
    <a href="/2012/03/08/2012-03-08-learn-vim-3-post/#comments" title="查看评论">
        <i class="fa fa-comments-o" aria-hidden="true"></i>
        <span class="count-comment"></span>
        
        
            <span class="disqus-comment-count" data-disqus-identifier="2012/03/08/2012-03-08-learn-vim-3-post/"></span>
        
    </a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/03/08/2012-03-08-learn-vim-3-post/">vim学习 jsctags</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><br>ctags不能非常胜任对现在的javascript代码的解析，尤其是遇到：<br><pre class="prettyprint"><br>Test.object.do = function(obj) {// …}<br>ajaxSetup: function( settings ) {//..}<br></pre><br>网上搜索了下，发现了doctorjs.git (以前叫jsctags), 号称被应用于Cloud9 IDE’s Ace online editor.<br><div class="comment"><br><ul><br>  <li>安装doctorjs需要nodejs环境，如何安装nodejs自己google去</li><br>  <li>安装ctags，brew也好macports也好。</li><br>  <li>git  clone <a href="https://github.com/mozilla/doctorjs.git" target="_blank" rel="external">https://github.com/mozilla/doctorjs.git</a> –recursive</li><br>  <li>make install</li><br>  <li>Add export NODE_PATH=/usr/local/lib/jsctags/:$NODE_PATH to your .zshrc or .bashrc</li><br>  <li>然后就可以使用了，直接jsctags your_js_dir</li><br>  <li>配合vim的tagbar非常好用。</li><br></ul><br></div><br><br></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术/">技术</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vim/">vim</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-2012-03-07-learn-vim-2-post" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/03/07/2012-03-07-learn-vim-2-post/" class="article-date">
      <time datetime="2012-03-07T11:18:00.000Z" itemprop="datePublished">2012-03-07</time>
</a>

 
    <a href="/2012/03/07/2012-03-07-learn-vim-2-post/#comments" title="查看评论">
        <i class="fa fa-comments-o" aria-hidden="true"></i>
        <span class="count-comment"></span>
        
        
            <span class="disqus-comment-count" data-disqus-identifier="2012/03/07/2012-03-07-learn-vim-2-post/"></span>
        
    </a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/03/07/2012-03-07-learn-vim-2-post/">vim学习 shiftwidth, tabstop, softtabstop和expandtab</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><br></p><h6>1. shiftwidth</h6><br><p><br>这个是用于程序中自动缩进所使用的空白长度指示的。一般来说为了保持程序的美观，和下面的参数最好一致。同时它也是符号移位(&gt;&gt;)长度的制定者。<br></p><br><p></p>

<p><br></p><h6>2. tabstop<br></h6><br><p><br>定义tab所等同的空格长度，一般来说最好设置成8，因为如果是其它值的话，可能引起文件在打印之类的场合中看起来很别扭。<br>除非你设置了 expandtab模式，也就是把tabs转换成空格，这样的话就不会一起混淆，不过毕竟制表符为8是最常用最普遍的设置，所以一般还是不要改。<br>(lz总是把它设置为4个空格)<br></p><br><p></p><br><p><br></p><h6>3. softtabstop</h6><br><p><br>如果我们希望改变程序中的缩进怎么办？shiftwidth和tabstop不一样的话，你会发现程序比较难看的。<br>这时候，softtabstop就起作用了。可以从vim的说明中看到，一旦设置了softtabstop的值时，你按下tab键，<br>插入的是空格和tab制表符的混合，具体如何混合取决于你设定的softtabstop，举个例子，如果设定softtabstop=8,<br>那么按下tab键，插入的就是正常的一个制表符;如果设定 softtabstop=16,那么插入的就是两个制表符；如果softtabstop=12,<br>那么插入的就是一个制表符加上4个空格；如果 softtabstop=4呢？那么一开始，插入的就是4个空格，此时一旦你再按下一次tab，<br>这次的四个空格就会和上次的四个空格组合起来变成一个制表符。<br>换句话说，softtabstop是“逢8空格进1制表符”,前提是你tabstop=8。<br></p><br><p></p><br><p><br></p><h6>4. expandtab</h6><br><p><br>因为tab的大小不一样，在多人一起开发项目时，为了使代码风格尽量保持一致，<br>一般不允许在代码使用TAB符，而以4个空格代之。<br></p><br><p></p>

<p></p><p>一般的shiftwidth, tabstop, softtabstop和expandtab的配置</p><p></p>
<pre class="prettyprint">
set shiftwidth=4                " use indents of 4 spaces
set tabstop=4                   " an indentation every four columns
set softtabstop=4               " let backspace delete indent
set expandtab                   " tabs are spaces, not tabs
</pre>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术/">技术</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vim/">vim</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-2012-03-07-learn-vim-1-post" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/03/07/2012-03-07-learn-vim-1-post/" class="article-date">
      <time datetime="2012-03-07T10:18:00.000Z" itemprop="datePublished">2012-03-07</time>
</a>

 
    <a href="/2012/03/07/2012-03-07-learn-vim-1-post/#comments" title="查看评论">
        <i class="fa fa-comments-o" aria-hidden="true"></i>
        <span class="count-comment"></span>
        
        
            <span class="disqus-comment-count" data-disqus-identifier="2012/03/07/2012-03-07-learn-vim-1-post/"></span>
        
    </a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/03/07/2012-03-07-learn-vim-1-post/">vim学习 listchars</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><br>在ruby-china.org混，看到很多vimer，于是就请教了如何学习vim，@jinleileiking同学就给了建议，非常中用，他说：<br><div class="comment"><br><ul><br><li>vimcasts.org 类似railscasts</li><br><li>[学习vi和Vim编辑器(第7版)].(Learning.the.vi.and.Vim.Editors.7th.Edition).A.Robbins&amp;E.Hannah&amp;L.Lamb.文字版</li><br><li>[Hacking.Vim].[Hacking.Vim].[Hacking.Vim].Packt.Publishing.Hacking.Vim.May.2007</li><br><li>:help vim内置帮助</li><br></ul></div><br><br></p>

<p><br>    先看vimcasts.org, 第一章：[显示不可视的字符] (<a href="http://vimcasts.org/episodes/show-invisibles/" target="_blank" rel="external">http://vimcasts.org/episodes/show-invisibles/</a>)<br><pre class="prettyprint"><br>“ 设置显示空格，tab的切换键<br>nmap &lt;leader&gt;l :set list!<cr><br><br>“ 设置tab用小三角加重复的空格显示，换行用横折符号显示。可以:help listchars<br>set listchars=tab:▸\ ,eol:¬<br></cr></pre><br></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术/">技术</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vim/">vim</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-2012-03-04-zsh-config-post" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/03/04/2012-03-04-zsh-config-post/" class="article-date">
      <time datetime="2012-03-04T10:18:00.000Z" itemprop="datePublished">2012-03-04</time>
</a>

 
    <a href="/2012/03/04/2012-03-04-zsh-config-post/#comments" title="查看评论">
        <i class="fa fa-comments-o" aria-hidden="true"></i>
        <span class="count-comment"></span>
        
        
            <span class="disqus-comment-count" data-disqus-identifier="2012/03/04/2012-03-04-zsh-config-post/"></span>
        
    </a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/03/04/2012-03-04-zsh-config-post/">oh my zsh</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>Mac自带zsh， 先设置你的默认shell为zsh</p><br><pre class="prettyprint"><br>chsh -s /bin/zsh<br></pre><br><p><br>然后使用oh-my-zsh的配置。参见<a href="https://github.com/robbyrussell/oh-my-zsh/" target="_blank" rel="external">oh my zsh</a><br><pre class="prettyprint"><br>cd ~<br>curl -L <a href="https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh" target="_blank" rel="external">https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh</a> | sh</pre><br></p><br><p>修改.zshrc,把你需要的环境变量配置全部加到.zshrc中去。定义自己的主题。可以在.oh-my-zsh/themes下面找到所有的主题<br>同时你也可以去<a href="https://github.com/robbyrussell/oh-my-zsh/wiki/themes" target="_blank" rel="external">themes</a>里去找你喜欢的主题。个人比较喜欢gnzh.<br><pre class="prettyprint"><br>zhangmatoMacBook-Pro.local ~/.oh-my-zsh/themes  ‹master›<br>Soliah.zsh-theme              daveverwer.zsh-theme          frisk.zsh-theme               josh.zsh-theme                mikeh.zsh-theme               rgm.zsh-theme                 suvash.zsh-theme<br>afowler.zsh-theme             dieter.zsh-theme              funky.zsh-theme               jreese.zsh-theme              miloshadzic.zsh-theme         risto.zsh-theme               takashiyoshida.zsh-theme<br>…<br></pre><br></p><br><p>安装插件，在.zshrc文件里找到”plugins=”,然后在里面添加你所需要的插件，你安装的插件可以在.oh-my-zsh/plugins下面找到。<br><pre class="prettyprint"><br>plugins=(rails3 rails git textmate ruby rvm gem git github brew bundler textmate pow)<br></pre><br></p>

<p><br>重启下终端，然后就可以使用订制好的zsh了。<br></p><br><p><br><img src="/photos/zsh.png"><br></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术/">技术</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/zsh/">zsh</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-2012-02-23-use-spf13-vim-config-post" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/02/23/2012-02-23-use-spf13-vim-config-post/" class="article-date">
      <time datetime="2012-02-23T10:18:00.000Z" itemprop="datePublished">2012-02-23</time>
</a>

 
    <a href="/2012/02/23/2012-02-23-use-spf13-vim-config-post/#comments" title="查看评论">
        <i class="fa fa-comments-o" aria-hidden="true"></i>
        <span class="count-comment"></span>
        
        
            <span class="disqus-comment-count" data-disqus-identifier="2012/02/23/2012-02-23-use-spf13-vim-config-post/"></span>
        
    </a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/02/23/2012-02-23-use-spf13-vim-config-post/">vim配置</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>一直用vi，也没仔细研究过，也不会配置，在网上发现<a href="http://spf13.com/project/spf13-vim" target="_blank" rel="external"><strong> spf13-vim </strong></a>,安装配置十分方便，于是便想推荐大家使用。</p><br><p>只需在终端敲打<br>    <pre class="prettyprint">curl <a href="https://raw.github.com/spf13/spf13-vim/3.0/bootstrap.sh" target="_blank" rel="external">https://raw.github.com/spf13/spf13-vim/3.0/bootstrap.sh</a> -L -o - | sh </pre><br>    等待数分钟，安装全部完成。具体细节不介绍，spf13-vim的网站上有详细介绍。<br></p><br><p>结束之后还需要.vimrc里加入<br><pre class="prettyprint"><br>set t_Co=256<br></pre><br></p>

<p><br>使用spf13-vim需要vim支持python，mac下的vim本身是不支持python的，如何验证vim支持python。<br><pre class="prettyprint"><br>:python print “Hello, world!”<br></pre><br>看到输出结果是Hello，world!就是支持python了。<br>如果不知道的话，那就要安装一个支持python的vim<br><pre class="prettyprint"><br>sudo port install vim +python +ruby<br></pre><br>安装之后，使用vi，如果发现有libiconv的问题，把你env里面的DYLD_LIBRARY_PATH去掉。<br></p>

<p></p><p>全部搞定，在用用你的vi看看，是不是很惊艳？</p><br><img src="/photos/vim.png"><p></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术/">技术</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vim/">vim</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-2012-02-19-add-google-pretty-code-post" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2012/02/19/2012-02-19-add-google-pretty-code-post/" class="article-date">
      <time datetime="2012-02-19T10:18:00.000Z" itemprop="datePublished">2012-02-19</time>
</a>

 
    <a href="/2012/02/19/2012-02-19-add-google-pretty-code-post/#comments" title="查看评论">
        <i class="fa fa-comments-o" aria-hidden="true"></i>
        <span class="count-comment"></span>
        
        
            <span class="disqus-comment-count" data-disqus-identifier="2012/02/19/2012-02-19-add-google-pretty-code-post/"></span>
        
    </a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2012/02/19/2012-02-19-add-google-pretty-code-post/">Add google pretty code support</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><em>Jekyll</em> 本身是不支持语法高亮的。而用 <em>Pygments</em> 又要装插件，看上去也挺复杂的。于是去网上搜索“博客语法高亮”，<br>然后发现了 <code>google code prettify</code>，心想 google 出品，质量必定可靠.具体请看下<a href="http://code.google.com/p/google-code-prettify/" target="_blank" rel="external"><strong>google code prettify</strong></a>。</p>
<p>这里就介绍一下，如何使用的。</p>
<p><ul></ul></p>
<p><li>从<a href="http://code.google.com/p/google-code-prettify/downloads/list下载最新的代码。" target="_blank" rel="external">http://code.google.com/p/google-code-prettify/downloads/list下载最新的代码。</a></li></p>
<p><li>解压出来，得到</li></p>
<p><pre><br>lang-apollo.js<br>lang-clj.js<br>lang-css.js<br>lang-go.js<br>lang-hs.js<br>lang-lisp.js<br>lang-lua.js<br>lang-ml.js<br>lang-n.js<br>lang-proto.js<br>lang-scala.js<br>lang-sql.js<br>lang-tex.js<br>lang-vb.js<br>lang-vhdl.js<br>lang-wiki.js<br>lang-xq.js<br>lang-yaml.js<br>prettify.css<br>prettify.js<br>sunburst.css<br></pre><br></p>
<p><li>把这些文件放到你的项目的目录下去。 </li></p>
<p><li>把css文件和js文件应用到页面上去。</li></p>
<p><pre class="prettyprint"><br>&lt;link href=”/js/google-code-prettify/sunburst.css” type=”text/css” rel=”stylesheet”/&gt;<br>&lt;script type=”text/javascript” src=”/js/google-code-prettify/prettify.js”&gt;&lt;/script&gt;<br></pre><br>在body上加一个onload函数</p>
<p><pre class="prettyprint"><br>&lt;body onload=”prettyPrint()” &gt;<br></pre><br></p>
<p><li>然后在要高亮的代码块使用提供的tag，比如：</li></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">pre</span> <span class="attr">class</span>=<span class="string">"prettyprint"</span>&gt;</span></div><div class="line">#include <span class="tag">&lt;<span class="name">stdio.h</span>&gt;</span></div><div class="line"></div><div class="line">/* the n-th fibonacci number.</div><div class="line"> */</div><div class="line">unsigned int fib(unsigned int n) &#123;</div><div class="line">    unsigned int a = 1, b = 1;</div><div class="line">    unsigned int tmp;</div><div class="line">    while (--n &gt;= 0) &#123;</div><div class="line">        tmp = a;</div><div class="line">        a += b;</div><div class="line">        b = tmp;</div><div class="line">    &#125;</div><div class="line">    return a;</div><div class="line">&#125;</div><div class="line"></div><div class="line">main() &#123;</div><div class="line">    printf("%u", fib(10));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></div></pre></td></tr></table></figure>
<p>你不需要指定语言环境,因为 prettyprint() 会对此进行猜测. 你也可以使用 prettyprint 这个类通过指定语言的拓展名来指定语言。<br></p>
<p><li><br>你看到的结果就是：</li></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="comment">/* the n-th fibonacci number.</span></div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">fib</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> a = <span class="number">1</span>, b = <span class="number">1</span>;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> tmp;</div><div class="line">    <span class="keyword">while</span> (--n &gt;= <span class="number">0</span>) &#123;</div><div class="line">        tmp = a;</div><div class="line">        a += b;</div><div class="line">        b = tmp;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> a;</div><div class="line">&#125;</div><div class="line"></div><div class="line">main() &#123;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%u"</span>, fib(<span class="number">10</span>));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><br><br></p><p></p>
<p><br>看上去不错吧，你也去试试吧！<br></p>

<p></p><br><br><br><p></p><p></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/技术/">技术</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/博客/">博客</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/5/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2012-2017 恒温
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>


    

    
        <script id="dsq-count-scr" src="//8atmyhouse.disqus.com/count.js" async></script>
        <script>
            if ($(".left-col").is(":visible")) {
                var $disqusCount = $(".disqus-comment-count");
                $disqusCount.bind("DOMNodeInserted", function(e) {
                    var num = $(this).text().replace(/[^0-9]/ig,"");
                    if (num > 0) {
                        $(this).siblings(".count-comment").text(num);
                    }
                    $(this).remove();
                })
            } else {
                $(".disqus-comment-count").remove();
            }
        </script>
     




<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>